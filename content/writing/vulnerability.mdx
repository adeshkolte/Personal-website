---
title: API Endpoint Leads to Account Takeover in Android/IOS Application
date: June 17, 2024
---

> What is a Token in API?

Tokens play a crucial role in token-based authentication, allowing an application to access an API. After a user successfully authenticates and authorizes access, the application receives an Access Token. This token is then used as a credential when calling the target API, ensuring that each user maintains authenticity with their unique token.

### The Discovery

One sunny afternoon, while analyzing an Android application, I stumbled upon an intriguing API endpoint. It was like finding a key that could potentially unlock any door within the application. This endpoint, designed to check user details, had a hidden vulnerability that could lead to a full account takeover.

![To chaliye shuru karte hai !!!](https://media1.tenor.com/images/c4af4edea40bb3f34873c36ed5df8833/tenor.gif)

To chaliye shuru karte hai !!!

### Step-by-Step Attack: The Journey Unfolds

### Step 1: Getting the Token for a User

To embark on this journey, the first step was to obtain the user's email. With this in hand, I intercepted the request 

![img-1](https://ad3.sh/1.png)

Using an interception tool like Burp Suite, I sent this request to the repeater. Here's how you can do it:

## Step 1: Intercept the Request

1. **Open Burp Suite and configure your device to use it as a proxy.**
2. **Launch the Android application and navigate to the login or user check section.**
3. **Intercept the network traffic and look for the request to `https://apiendpoint.com/admin/apis/mobile/v1/check_user`.**

## Step 2: Send the Request to Repeater

1. **Once you intercept the request, right-click on it and send it to the repeater tab in Burp Suite.**
    ![img-2](https://ad3.sh/2.png)

## Step 3: Modify the Request

1. **In the repeater tab, modify the request by entering the victim's user ID in place of the original user ID.**
2. **Click on "Send" and observe the response.**

### Extract the Token

Check the response for the token. If the vulnerability exists, the token will be included in the response.

To my astonishment, the response contained the victim's token. It was like discovering a secret passageway in a seemingly secure fortress.

## Step 4: Exploiting the Token

Armed with this token, the possibilities were endless. The attacker could perform any operation provided by the Android application. It was like having a master key to the kingdom.

![4](https://ad3.sh/3.png)

Here are some of the exploits an attacker could achieve:

![U](https://ad3.sh/4.png)

1. **Update Profile of Any User:** Use the token to send a request to the profile update endpoint, modifying the victim's personal details.
2. **Get Profile of Any User:** Use the token to access the profile information endpoint, retrieving sensitive information.
3. **Get Payment History:** Use the token to access the payment history endpoint, viewing the victim's financial transactions.
4. **Withdraw Request:** Use the token to initiate a withdrawal request, potentially draining the victim's funds.

The vulnerability was glaring, and the potential damage was immense.

## The Fix

Ensure that tokens are validated with additional checks, ensuring they belong to the authenticated user before allowing any operations.

## Reward

For this significant find, I received a $10,000 bounty, underscoring the value of diligent security research.
